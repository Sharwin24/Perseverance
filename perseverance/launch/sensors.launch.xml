<launch>
  <!-- Common args -->
  <arg name="namespace" default="" description="Namespace for sensor nodes"/>
  <arg name="log_level" default="info" description="Logging level for all nodes"/>

  <!-- Select real or simulated sensors -->
  <arg name="use_sim_sensors" default="true" description="Use simulated or real sensors [true, false]"/>

  <!-- Toggle managers explicitly (usually you want them) -->
  <arg name="start_managers" default="true" description="Start sensor managers that process sensor data"/>

  <!-- Param files -->
  <arg name="drivers_param_file"   default="$(find-pkg-share perseverance)/config/drivers.yaml"/>
  <arg name="sim_param_file"       default="$(find-pkg-share perseverance)/config/sim.yaml"/>
  <arg name="managers_param_file"  default="$(find-pkg-share perseverance)/config/managers.yaml"/>

  <!-- Manager topic args (bubble up so users can override at the top level) -->
  <arg name="scan_topic" default="scan"/>
  <arg name="map_topic"  default="map"/>

  <!-- Real hardware drivers (only when not sim) -->
  <include file="$(find-pkg-share perseverance)/launch/sensors_drivers.launch.xml" unless="$(var use_sim_sensors)">
    <arg name="namespace"  value="$(var namespace)"/>
    <arg name="param_file" value="$(var drivers_param_file)"/>
    <arg name="log_level"  value="$(var log_level)"/>
  </include>

  <!-- Simulated drivers (only when sim) -->
  <include file="$(find-pkg-share perseverance)/launch/sensors_sim.launch.xml" if ="$(var use_sim_sensors)">
    <arg name="namespace"  value="$(var namespace)"/>
    <arg name="param_file" value="$(var sim_param_file)"/>
    <arg name="log_level"  value="$(var log_level)"/>
  </include>

  <!-- Managers (optional) -->
  <include file="$(find-pkg-share perseverance)/launch/sensors_managers.launch.xml" if ="$(var start_managers)">
    <arg name="namespace"  value="$(var namespace)"/>
    <arg name="param_file" value="$(var managers_param_file)"/>
    <arg name="log_level"  value="$(var log_level)"/>
    <arg name="scan_topic" value="$(var scan_topic)"/>
    <arg name="map_topic"  value="$(var map_topic)"/>
  </include>
</launch>
